{% extends "base.html" %}

{% block title %}ðŸŽ¬ TV KaraokÃª{% endblock %}
{% block extra_css %}
<style>
    html,
    body {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: black;
        color: white;
        font-family: sans-serif;
        overflow: hidden;
    }

    .container {
        padding: 2vw;
        text-align: center;
    }

    h2 {
        font-size: clamp(1.5rem, 4vw, 4rem);
        margin-bottom: 2vw;
    }

    h4 {
        font-size: clamp(1rem, 2.5vw, 2.5rem);
        margin-bottom: 2vw;
    }

  iframe {
    width: 200vw;          /* 200% da largura da viewport */
    max-width: 1700px;     /* largura mÃ¡xima fixa */
    aspect-ratio: 16 / 9;  /* mantÃ©m proporÃ§Ã£o widescreen */
    height: auto;          /* altura ajustada automaticamente pela proporÃ§Ã£o */
    max-height: 1908px;    /* altura proporcional ao width 200vw */
    border: none;
    margin: 0 auto;
    display: block;
}



    .btn-lg {
        font-size: clamp(1rem, 2vw, 2rem);
        padding: 1rem 2rem;
    }

    @media (max-width: 600px) {
        .container {
            padding: 5vw;
        }

        h2,
        h4 {
            margin-bottom: 4vw;
        }

        iframe {
            width: 100%;
            max-width: 100%;
            max-height: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    {% if cantor %}
    <h2>ðŸŽ¤ PrÃ³ximo cantor: {{ cantor.usuario.first_name }} {{ cantor.usuario.last_name }}</h2>
    <h4>ðŸŽµ MÃºsica: {{ cantor.musica }}</h4>

    {% if video_id %}
    <iframe id="youtube-player" src="https://www.youtube.com/embed/{{ video_id }}?autoplay=1&rel=0&enablejsapi=1"
        title="YouTube video player"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>
    </iframe>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const iframe = document.getElementById('youtube-player');
            const requestFullScreen = iframe.requestFullscreen || iframe.mozRequestFullScreen || iframe.webkitRequestFullscreen || iframe.msRequestFullscreen;
            if (requestFullScreen) {
                iframe.addEventListener('load', function () {
                    setTimeout(() => requestFullScreen.call(iframe), 1000);
                });
            }
        });

        // Atualiza a pÃ¡gina automaticamente a cada 5 minutos (300000 ms)
        setTimeout(() => {
            location.reload();
        }, 300000);
    </script>

    {% else %}
    <p>ðŸŽ¬ NÃ£o foi possÃ­vel encontrar o vÃ­deo automaticamente.</p>
    <a href="https://www.youtube.com/results?search_query={{ cantor.musica|urlencode }} karaoke" target="_blank"
        class="btn btn-danger btn-lg">
        ðŸ”Ž Buscar no YouTube
    </a>
    {% endif %}
    {% else %}
    <h2>Nenhum cantor na fila ðŸŽ¶</h2>
    {% endif %}
</div>
{% endblock %}